---
title: 数值积分（五）：可分解法则和精度递归改进
date: 2024-07-30 10:41:37
tags: 数值积分
categories: 数值计算和程序设计
---
## 可分解法则

梯形法则仅给出了一个步长范围内的值，要计算整个区间上的值，就要把整个计算区间进行划分，对划分成的每个小区间使用梯形法则.

因此我们可以得到

$$\int^b_af(x)\mathrm{d}x\approx\sum^{N-1}_{j=0}\dfrac h2(f_j+f_{j+1})=\dfrac h2\left(f_0+f_N+2\sum^{N-1}_{j=1}f_j\right)\tag{5.1}$$

其中 $h=\dfrac{b-a}{N}$.

如果使用 Simpson 法则，就会得到

$$\int^b_af(x)\mathrm{d}x\approx\sum^{N-1}_{j=0}\dfrac h3(f_{2j}+4f_{2j+1}+f_{2j+2})=\dfrac h3\left(f_0+f_N+2\sum^{N-1}_{j=1}f_{2j}+4\sum^{N-1}_{j=0}f_{2j+1}\right)\tag{5.2}$$

其中 $h=\dfrac{b-a}{2N}$.

## 精度递归改进

以梯形法则为例，选取 $2h$ 作为步长，则积分近似值即为

$$\int^b_af(x)\mathrm{d}x\approx\sum^{N/2-1}_{j=0}h(f_{2j}+f_{2j+2})=h\left(f_0+f_N+2\sum^{N/2-1}_{j=1}f_{2j}\right)\tag{5.3}$$

对比式 (5.1) 和式 (5.3) ，可以发现步长为 $h$ 的方案包含了步长为 $2h$ 的方案，即

$$Q_{h}=\dfrac12Q_{2h}+h\sum^{N/2-1}_{j=0}f_{2j+1}\tag{5.4}$$

这样做的好处是可以逐步得到我们想要的精度，并且便于编写 MATLAB 程序.
